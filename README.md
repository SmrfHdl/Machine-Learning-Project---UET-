# **ThÃ´ng Tin Dá»± Ãn**

> **TÃªn Dá»± Ãn**: Nháº­n diá»‡n biá»ƒn bÃ¡o giao thÃ´ng
>
> **TÃªn nhÃ³m:** Há»™i ngÆ°á»i cao tuá»•i

**NgÃ y thá»±c hiá»‡n:** 14/05/2024

>

**Repostories Github:** https://github.com/SmrfHdl/Machine-Learning-Project---UET-.git

# **CÃ¡c thÃ nh viÃªn cá»§a nhÃ³m:**

| Há» tÃªn                       | MSSV     |
| ---------------------------- | -------- |
| Nguyá»…n Viáº¿t VÅ© (TrÆ°á»Ÿng nhÃ³m) | 22022632 |
| Pháº¡m VÄƒn TrÆ°á»ng              | 22022564 |
| Tráº§n An Tháº¯ng                | 22022525 |

# **Báº£ng phÃ¢n chia nhiá»‡m vá»¥**
| Nhiá»‡m vá»¥  	                          | NgÆ°á»i phá»¥ trÃ¡ch                               | 
| --------------------------------------- | --------------------------------------------- | 
|Táº¡o vÃ  update repo	                      |Pháº¡m VÄƒn TrÆ°á»ng                                |
|Thu tháº­p vÃ  tiá»n xá»­ lÃ½ dá»¯ liá»‡u	          |Nguyá»…n Viáº¿t VÅ©                                 |
|Lá»±a chá»n vÃ  triá»ƒn khai mÃ´ hÃ¬nh           |Pháº¡m VÄƒn TrÆ°á»ng, Nguyá»…n Viáº¿t VÅ©, Tráº§n An Tháº¯ng |  
|ÄÃ¡nh giÃ¡ hiá»‡u suáº¥t vÃ  tá»‘i Æ°u hÃ³a mÃ´ hÃ¬nh |Tráº§n An Tháº¯ng                                  |
|Training vÃ  Ä‘Ã¡nh giÃ¡ meta-model          |Pháº¡m VÄƒn TrÆ°á»ng	                              |
|VIáº¿t bÃ¡o cÃ¡o                             |Nguyá»…n Viáº¿t VÅ©	                              |

</aside>

# 1. Tá»•ng quan vá» dá»± Ã¡n

## 1.1. Tá»•ng quan

NgÃ y nay, cÆ¡ sá»Ÿ háº¡ táº§ng giao thÃ´ng ngÃ y cÃ ng phÃ¡t triá»ƒn, viá»‡c phÃ¡t hiá»‡n biá»ƒn bÃ¡o Ä‘á»ƒ cung cáº¥p thÃ´ng tin Ä‘áº¿n ngÆ°á»i tham gia giao thÃ´ng lÃ  má»™t Ä‘iá»u ráº¥t quan trá»ng. Táº­n dá»¥ng nhá»¯ng kiáº¿n thá»©c Ä‘Ã£ Ä‘Æ°á»£c há»c á»Ÿ mÃ´n Machine Learning, káº¿t há»£p vá»›i nhá»¯ng Ä‘iá»u gáº§n gÅ©i vá»›i Ä‘á»i sá»‘ng. NhÃ³m tÃ´i Ä‘Ã£ chá»n Ä‘á» tÃ i â€œPhÃ¡t hiá»‡n cÃ¡c loáº¡i biá»ƒn bÃ¡o giao thÃ´ngâ€ lÃ m Ä‘á» tÃ i nghiÃªn cá»©u. GiÃºp má»i ngÆ°á»i cÃ³ thá»ƒ hiá»ƒu Ä‘Ã¢u lÃ  biá»ƒn bÃ¡o giao thÃ´ng vÃ  chÃºng cÃ³ Ã½ nghÄ©a tháº¿ nÃ o.

## 1.2. MÃ´ táº£ bÃ i toÃ¡n

1. Input: Má»™t bá»©c áº£nh cÃ³ chá»©a biá»ƒn bÃ¡o
2. Output: TÃªn biá»ƒn bÃ¡o

# 2. XÃ¢y dá»±ng bá»™ dá»¯ liá»‡u

Vá» dá»¯ liá»‡u, nhÃ³m tÃ´i sáº½ sá»­ dá»¥ng bá»™ dá»¯ liá»‡u biá»ƒn bÃ¡o giao thÃ´ng ná»•i tiáº¿ng Ä‘Ã³ lÃ  German Traffic Sign.

Bá»™ dá»¯ liá»‡u German Traffic Sign (GTSRB) lÃ  má»™t bá»™ dá»¯ liá»‡u chá»©a hÃ¬nh áº£nh vá» cÃ¡c biá»ƒn bÃ¡o giao thÃ´ng Äá»©c, Ä‘Æ°á»£c sá»­ dá»¥ng phá»• biáº¿n trong lÄ©nh vá»±c nháº­n dáº¡ng biá»ƒn bÃ¡o giao thÃ´ng vÃ  thá»‹ giÃ¡c mÃ¡y tÃ­nh. Bá»™ dá»¯ liá»‡u nÃ y thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡ cÃ¡c mÃ´ hÃ¬nh há»c mÃ¡y vÃ  máº¡ng nÆ¡-ron sÃ¢u trong viá»‡c nháº­n dáº¡ng cÃ¡c biá»ƒn bÃ¡o giao thÃ´ng.

## 2.1. ThÃ´ng tin vá» bá»™ dá»¯ liá»‡u

Bá»™ dá»¯ liá»‡u nÃ y gá»“m khoáº£ng gáº§n 40k áº£nh chia thÃ nh 43 folder lÃ  43 loáº¡i biá»ƒn bÃ¡o khÃ¡c nhau. Má»—i folder sáº½ cÃ³ 1 file CSV chá»©a thÃ´ng tin cÃ¡c áº£nh trong thÆ° má»¥c.

DÆ°á»›i Ä‘Ã¢y lÃ  má»™t sá»‘ thÃ´ng tin chi tiáº¿t vá» bá»™ dá»¯ liá»‡u GTSRB:

- **Sá»‘ LÆ°á»£ng Lá»›p**: 43 (má»—i lá»›p tÆ°Æ¡ng á»©ng vá»›i má»™t loáº¡i biá»ƒn bÃ¡o giao thÃ´ng)
- **KÃ­ch ThÆ°á»›c HÃ¬nh áº¢nh**: Äa dáº¡ng, thÆ°á»ng lÃ  32x32 pixel hoáº·c 64x64 pixel
- **Sá»‘ LÆ°á»£ng HÃ¬nh áº¢nh**: Khoáº£ng 50,000 hÃ¬nh áº£nh Ä‘Æ°á»£c chia thÃ nh táº­p huáº¥n luyá»‡n, táº­p xÃ¡c thá»±c vÃ  táº­p kiá»ƒm thá»­
- **Äá»‹nh Dáº¡ng HÃ¬nh áº¢nh**: PNG hoáº·c JPEG

## 2.2. Äá»c vÃ  xá»­ lÃ½ dá»¯ liá»‡u

Bá»Ÿi vÃ¬ táº­p dá»¯ liá»‡u á»Ÿ dáº¡ng áº£nh, khÃ´ng thá»ƒ trá»±c tiáº¿p Ä‘Æ°a vÃ o model Ä‘á»ƒ tiáº¿n hÃ nh trainning, vÃ¬ váº­y tÃ´i cáº§n pháº£i trÃ­ch xuáº¥t nhá»¯ng Ä‘áº·c trÆ°ng cá»§a áº£nh. VÃ  ká»¹ thuáº­t Ä‘Æ°á»£c sá»­ dá»¥ng á»Ÿ Ä‘Ã¢y lÃ  HOG (Histograms of Oriented Gradients)

### 2.2.1. HOG (Histograms of Oriented Gradients)

TÃ´i sáº½ sá»­ dá»¥ng HOG((histogram of oriented gradients) Ä‘á»ƒ trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng trÃªn nhá»¯ng vÃ¹ng mÃ  cá»­a sá»• trÆ°á»£t qua.

Histograms of Oriented Gradients (HOG) lÃ  má»™t ká»¹ thuáº­t trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng tá»« hÃ¬nh áº£nh, Ä‘Æ°á»£c sá»­ dá»¥ng rá»™ng rÃ£i trong cÃ¡c bÃ i toÃ¡n thá»‹ giÃ¡c mÃ¡y tÃ­nh nhÆ° phÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng vÃ  nháº­n dáº¡ng máº«u. HOG Ä‘Æ°á»£c giá»›i thiá»‡u bá»Ÿi Navneet Dalal vÃ  Bill Triggs vÃ o nÄƒm 2005 trong bÃ i bÃ¡o "Histograms of Oriented Gradients for Human Detection".


Resize áº£nh thÃ nh kÃ­ch thÆ°á»›c 128x128 pixels nháº±m giÃºp cho Ä‘áº·c trÆ°ng áº£nh thu Ä‘Æ°á»£c khÃ´ng quÃ¡ Ã­t, Ä‘á»“ng thá»i cÅ©ng khÃ´ng táº¡o ra quÃ¡ nhiá»u tham sá»‘ giáº£m thá»i gian táº£i dá»¯ liá»‡u vÃ  huáº¥n luyá»‡n mÃ´ hÃ¬nh.

### 2.2.2. Äá»c dá»¯ liá»‡u vÃ  trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng

Äáº·c trÆ°ng cá»§a má»—i áº£nh Ä‘Æ°á»£c trÃ­ch xuáº¥t ra tá»« táº­p training sáº½ lÃ  má»™t Ä‘iá»ƒm dá»¯ liá»‡u trong má»™t khÃ´ng gian Ä‘a chiá»u. á» Ä‘Ã¢y vá»›i áº£nh Ä‘Æ°á»£c resize thÃ nh 128\*128px thÃ¬ sá»‘ chiá»u cá»§a khÃ´ng gian nÃ y sáº½ lÃ :

$$
(\frac{128}{8}_{(cells)}-1).(\frac{128}{8}_{(cells)}-1).(9_{(bins)}.4_{(blocks)})=8100
$$

```python
array([0.21429373, 0.23669159, 0.23669159, ..., 0.01807657, 0.00958505, 0. ]) # Arr 1 chiá»u 8100 features nhÆ° má»™t Ä‘iá»ƒm trong khÃ´ng gian Ä‘a chiá»u
```

### **2.2.3. Thá»‘ng kÃª vÃ  xá»­ lÃ½ dá»¯ liá»‡u khÃ´ng cÃ¢n báº±ng**

Sá»‘ lÆ°á»£ng nhÃ£n chÃªnh lá»‡ch lÃ  ráº¥t lá»›n, Ä‘iá»u nÃ y sáº½ lÃ m phÃ¡t sinh má»™t sá»‘ váº¥n Ä‘á»:

- **Hiá»‡u suáº¥t khÃ´ng Ä‘á»“ng Ä‘á»u:** MÃ´ hÃ¬nh sáº½ cÃ³ xu hÆ°á»›ng dá»± Ä‘oÃ¡n nhÃ£n cÃ³ nhiá»u dá»¯ liá»‡u hÆ¡n. Äiá»u nÃ y lÃ m cho mÃ´ hÃ¬nh kÃ©m hiá»‡u quáº£ trong viá»‡c dá»± Ä‘oÃ¡n nhÃ£n cÃ³ Ã­t dá»¯ liá»‡u.
- **Äá»™ chÃ­nh xÃ¡c bá»‹ lá»‡ch:** CÃ¡c chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡ nhÆ° Ä‘á»™ chÃ­nh xÃ¡c (accuracy) sáº½ bá»‹ lá»‡ch náº¿u khÃ´ng cÃ³ sá»± cÃ¢n báº±ng giá»¯a cÃ¡c nhÃ£n. MÃ´ hÃ¬nh cÃ³ thá»ƒ Ä‘áº¡t Ä‘á»™ chÃ­nh xÃ¡c cao Ä‘Æ¡n giáº£n vÃ¬ nÃ³ Ä‘oÃ¡n Ä‘Ãºng nhiá»u máº«u tá»« nhÃ£n cÃ³ nhiá»u dá»¯ liá»‡u.

Váº¥n Ä‘á» dá»¯ liá»‡u khÃ´ng cÃ¢n báº±ng cÃ³ thá»ƒ Ä‘Æ°á»£c giáº£i quyáº¿t vá»›i cÃ¡c mÃ´ hÃ¬nh Ensemble nhÆ° Random Forest, tuy nhiÃªn Ä‘á»ƒ cÃ³ thá»ƒ sá»­ dá»¥ng mÃ´ hÃ¬nh SVM thÃ¬ tÃ´i sáº½ cáº§n pháº£i sá»­ dá»¥ng ká»¹ thuáº­t Resampling báº±ng SMOTE cá»§a thÆ° viá»‡n â€˜imblearnâ€™. SMOTE (Synthetic Minority Over-sampling) vÃ  ADASYN (Adaptive synthetic sampling) lÃ  cÃ¡c phÆ°Æ¡ng phÃ¡p sinh máº«u nháº±m gia tÄƒng kÃ­ch thÆ°á»›c máº«u cá»§a nhÃ³m thiá»ƒu sá»‘ trong trÆ°á»ng há»£p xáº£y ra máº¥t cÃ¢n báº±ng máº«u. Äá»ƒ gia tÄƒng kÃ­ch thÆ°á»›c máº«u, vá»›i má»—i má»™t máº«u thuá»™c nhÃ³m thiá»ƒu sá»‘ ta sáº½ lá»±a chá»n ra ğ‘˜ máº«u lÃ¡ng giá»ng gáº§n nháº¥t vá»›i nÃ³ vÃ  sau Ä‘Ã³ thá»±c hiá»‡n tá»• há»£p tuyáº¿n tÃ­nh Ä‘á»ƒ táº¡o ra máº«u giáº£ láº­p.

Sau khi tÃ­nh toÃ¡n giÃ¡ trá»‹ trung bÃ¬nh lÃ  khoáº£ng 1000 dá»¯ liá»‡u trÃªn má»—i nhÃ£n, tÃ´i tiáº¿n hÃ nh táº¡o thÃªm dá»¯ liá»‡u Ä‘á»ƒ cÃ¡c nhÃ£n cÃ³ sá»‘ dá»¯ liá»‡u quÃ¡ tháº¥p Ä‘áº¡t tá»›i 1000 dá»¯ liá»‡u.

Káº¿t quáº£ cho tháº¥y hÃ m Ä‘Ã£ hoáº¡t Ä‘á»™ng tá»‘t vÃ  cho ra táº­p dá»¯ liá»‡u khÃ¡ cÃ¢n báº±ng.

### 2.2.4. Chia táº­p dá»¯ liá»‡u

Tiáº¿p theo Ä‘á»ƒ cÃ³ thá»ƒ Ä‘Ã¡nh giÃ¡ vÃ  tá»‘i Æ°u hÃ³a mÃ´ hÃ¬nh tÃ´i sáº½ tiáº¿n hÃ nh chia táº­p dá»¯ liá»‡u thÃ nh 3 pháº§n train - val - test vá»›i tá»‰ lá»‡ 70% - 10% - 15%

Dá»¯ liá»‡u Ä‘Ã£ sáºµn sÃ ng, tÃ´i sáº½ tiáº¿n tá»›i bÆ°á»›c training model!!!

# 3. Training vÃ  Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh

## 3.1. Chá»n base model Ä‘á»ƒ training

Nhá»¯ng model Ä‘Æ°á»£c tÃ´i sá»­ dá»¥ng trong bÃ i toÃ¡n nÃ y sáº½ lÃ  Support Vector Machine(SVM), K-Nearest Neighbor(KNN) vÃ  Random Forest(RF)

### **3.1.1. Support Vector Machine (SVM)**:

- SVM lÃ  má»™t lá»±a chá»n phá»• biáº¿n khi lÃ m viá»‡c vá»›i dá»¯ liá»‡u cÃ³ sá»‘ lÆ°á»£ng lá»›n cÃ¡c Ä‘áº·c trÆ°ng, nhÆ° trong trÆ°á»ng há»£p cá»§a HOG.
- SVM hoáº¡t Ä‘á»™ng tá»‘t khi dá»¯ liá»‡u lÃ  tuyáº¿n tÃ­nh hoáº·c cÃ³ thá»ƒ chuyá»ƒn Ä‘á»•i thÃ nh tuyáº¿n tÃ­nh thÃ´ng qua cÃ¡c hÃ m kernel.
- SVM cÃ³ thá»ƒ Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch thay Ä‘á»•i siÃªu tham sá»‘ nhÆ° C (tham sá»‘ Ä‘Ã²i há»i máº¡nh máº½) vÃ  kernel Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tá»‘t nháº¥t.

### 3.1.2. Random Forest:

- Random Forest lÃ  má»™t phÆ°Æ¡ng phÃ¡p há»c mÃ¡y ensemble dá»±a trÃªn cÃ¢y quyáº¿t Ä‘á»‹nh.
- Äá»‘i vá»›i dá»¯ liá»‡u HOG, Random Forest cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¢y dá»±ng má»™t táº­p há»£p cÃ¡c cÃ¢y quyáº¿t Ä‘á»‹nh Ä‘á»ƒ phÃ¢n loáº¡i áº£nh.
- Äáº·c Ä‘iá»ƒm cá»§a Random Forest lÃ  khÃ´ng nháº¡y cáº£m vá»›i overfitting vÃ  cÃ³ kháº£ nÄƒng lÃ m viá»‡c tá»‘t vá»›i dá»¯ liá»‡u cÃ³ nhiá»…u.

### 3.1.3. **K-Nearest Neighbors (KNN)**:

- KNN lÃ  má»™t phÆ°Æ¡ng phÃ¡p há»c mÃ¡y Ä‘Æ¡n giáº£n nhÆ°ng máº¡nh máº½ trong viá»‡c phÃ¢n loáº¡i dá»¯ liá»‡u.
- KNN hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch xÃ¡c Ä‘á»‹nh nhÃ£n cho má»™t Ä‘iá»ƒm dá»¯ liá»‡u má»›i báº±ng cÃ¡ch so sÃ¡nh nÃ³ vá»›i cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u trong táº­p huáº¥n luyá»‡n gáº§n nháº¥t (K Ä‘iá»ƒm gáº§n nháº¥t).
- HOG cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng nhÆ° lÃ  Ä‘áº·c trÆ°ng Ä‘áº§u vÃ o cho má»—i Ä‘iá»ƒm dá»¯ liá»‡u.
- KNN khÃ´ng cáº§n huáº¥n luyá»‡n trÆ°á»›c vÃ  cÃ³ thá»ƒ Ã¡p dá»¥ng trá»±c tiáº¿p vÃ o dá»¯ liá»‡u má»›i mÃ  khÃ´ng cáº§n pháº£i tÃ¡i huáº¥n luyá»‡n toÃ n bá»™ mÃ´ hÃ¬nh.

â†’ Tuy nhiÃªn, KNN cÃ³ thá»ƒ Ä‘Ã²i há»i nhiá»u tÃ i nguyÃªn tÃ­nh toÃ¡n khi sá»‘ lÆ°á»£ng Ä‘iá»ƒm dá»¯ liá»‡u trong táº­p huáº¥n luyá»‡n lá»›n.

## 3.2. ÄÃ¡nh giÃ¡ cÃ¡c base model

### 3.2.1. **ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh SVM**

```python
ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh SVM trÃªn dá»¯ liá»‡u validation:
Accuracy: 0.9451306413301662
```

Trong bÃ¡o cÃ¡o phÃ¢n loáº¡i cá»§a mÃ´ hÃ¬nh SVM, chÃºng ta tháº¥y ráº±ng precision, recall vÃ  f1-score Ä‘á»u cao cho háº§u háº¿t cÃ¡c lá»›p. Äiá»u nÃ y cho tháº¥y mÃ´ hÃ¬nh SVM cÃ³ kháº£ nÄƒng phÃ¢n loáº¡i tá»‘t trÃªn cáº£ cÃ¡c lá»›p lá»›n vÃ  nhá». Precision vÃ  recall gáº§n nhÆ° Ä‘á»u cao cho táº¥t cáº£ cÃ¡c lá»›p, chá»‰ cÃ³ má»™t sá»‘ lá»›p cÃ³ má»™t vÃ i Ä‘iá»ƒm sá»‘ tháº¥p hÆ¡n, nhÆ°ng váº«n Ä‘áº¡t Ä‘Æ°á»£c hiá»‡u suáº¥t tá»‘t (vÃ­ dá»¥: lá»›p 6, lá»›p 21, lá»›p 22).

Sá»Ÿ dÄ© mÃ´ hÃ¬nh SVM Ä‘áº¡t Ä‘Æ°á»£c Ä‘á»™ chÃ­nh xÃ¡c xao nhÆ° váº­y lÃ  vÃ¬ mÃ´ hÃ¬nh nÃ y Ä‘áº·c biá»‡t hoáº¡t Ä‘á»™ng tá»‘t trÃªn cÃ¡c táº­p dá»¯ liá»‡u nhiá»u chiá»u nhÆ° Ä‘áº·c trÆ°ng HOG.

### 3.2.2. **ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh Random Forest**

```python
ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh Random Forest trÃªn dá»¯ liá»‡u validation:
Accuracy: 0.9346793349168646
```

Báº£ng Ä‘Ã¡nh giÃ¡ cho tháº¥y mÃ´ hÃ¬nh cÃ³ hiá»‡u suáº¥t tá»‘t trÃªn háº§u háº¿t cÃ¡c lá»›p, vá»›i precision, recall vÃ  F1-score Ä‘á»u á»•n Ä‘á»‹nh. Random Forest hoáº¡t Ä‘á»™ng tá»‘t trÃªn dá»¯ liá»‡u HOG vÃ¬ kháº£ nÄƒng xá»­ lÃ½ khÃ´ng gian Ä‘áº·c trÆ°ng lá»›n, dá»… dÃ ng Ã¡nh xáº¡ cÃ¡c máº«u dá»¯ liá»‡u vÃ  khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi biáº¿n Ä‘á»•i khÃ´ng quan trá»ng cá»§a dá»¯ liá»‡u.

### 3.2.3. **ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh KNN**

```python
ÄÃ¡nh giÃ¡ mÃ´ hÃ¬nh KNN trÃªn dá»¯ liá»‡u validation:
Accuracy: 0.66270783847981
```

- Táº¡i biá»ƒn bÃ¡o nhÃ£n 0 (Speed Limit 20) cÃ³ chá»‰ sá»‘ precision ráº¥t tháº¥p (9%) Ä‘iá»u nÃ y xáº£y ra lÃ  do háº§u háº¿t cÃ¡c biá»ƒn bÃ¡o speed limit cÃ³ hÃ¬nh dÃ¡ng khÃ¡ tÆ°Æ¡ng Ä‘á»“ng, chá»‰ thay Ä‘á»•i má»—i con sá»‘ á»Ÿ trong biá»ƒn bÃ¡o. Viá»‡c sá»­ dá»¥ng HOG trÃ­ch xuáº¥t Ä‘áº·c trÆ°ng áº£nh vá»›i tá»‰ lá»‡ áº£nh lÃ  128\*128px cÅ©ng sáº½ lÃ m cho nhá»¯ng con sá»‘ trong biá»ƒn bÃ¡o trá»Ÿ nÃªn khÃ³ phÃ¢n biá»‡t hÆ¡n vá»›i mÃ´ hÃ¬nh KNN, chÃ­nh vÃ¬ váº­y mÃ  tá»‰ lá»‡ precision cá»§a biá»ƒn nhÃ£n 0 ráº¥t tháº¥p vÃ  tá»‰ lá»‡ recall láº¡i cao hÆ¡n so vá»›i cÃ¡c biá»ƒn speed limit khÃ¡c (tá»« 1 - 8). NgoÃ i ra sá»‘ support cÅ©ng tháº¥p hÆ¡n so vá»›i cÃ¡c biá»ƒn cÃ²n láº¡i cÅ©ng dáº«n Ä‘áº¿n viá»‡c chá»‰ sá»‘ recall cao.
- Äiá»u nÃ y cÅ©ng xáº£y ra tÆ°Æ¡ng tá»± vá»›i biá»ƒn sá»‘ 11 vÃ  biá»ƒn sá»‘ 27 khi hÃ¬nh dÃ¡ng khÃ¡ tÆ°Æ¡ng tá»± nhau:

Nhá»¯ng áº£nh cÃ³ hÃ¬nh dÃ¡ng tÆ°Æ¡ng tá»± nhau sáº½ gÃ¢y ra sá»± nháº§m láº«n lá»›n Ä‘á»‘i vá»›i mÃ´ hÃ¬nh KNN

NhÃ¬n chung viá»‡c sá»­ dá»¥ng mÃ´ hÃ¬nh KNN Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ vá»›i cÃ¡c táº­p dá»¯ liá»‡u lá»›n vÃ  cÃ³ Ä‘á»™ phá»©c táº¡p cao vá» cáº£ dá»¯ liá»‡u vÃ  khÃ´ng gian Ä‘áº·c trÆ°ng sáº½ Ä‘em láº¡i hiá»‡u quáº£ ráº¥t kÃ©m. Vá»›i khÃ´ng gian vá»›i 8100 chiá»u thÃ¬ cÃ¡c máº«u sáº½ trá»Ÿ nÃªn xa nhau trong khÃ´ng gian Ä‘áº·c trÆ°ng, lÃ m cho viá»‡c tÃ¬m lÃ¡ng giá»ng gáº§n nháº¥t trá»Ÿ nÃªn khÃ³ khÄƒn vÃ  khÃ´ng chÃ­nh xÃ¡c.

## 3.3. Tá»‘i Æ°u model

Sau quÃ¡ trÃ¬nh Ä‘Ã¡nh giÃ¡ thÃ¬ tÃ´i Ä‘Ã£ quyáº¿t Ä‘á»‹nh chá»n 2 model Ä‘á»ƒ tiáº¿n hÃ nh stacking sá»­ dá»¥ng Logistic Regrestion Ä‘á»ƒ chá»n káº¿t quáº£ tá»‘t nháº¥t. TrÆ°á»›c Ä‘Ã³ tÃ´i sáº½ tiáº¿n hÃ nh tá»‘i Æ°u model SVM sá»­ dá»¥ng phÆ°Æ¡ng phÃ¡p Grid Search:

### 3.3.1. Tá»‘i Æ°u model SVM

TÃ´i sáº½ sá»­ dá»¥ng Grid Search Ä‘á»ƒ tÃ¬m kiáº¿m siÃªu tham sá»‘ tá»‘i Æ°u cho mÃ´ hÃ¬nh SVM. Cá»¥ thá»ƒ, chÃºng ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh má»™t danh sÃ¡ch cÃ¡c giÃ¡ trá»‹ cho tham sá»‘ "C", Ä‘Ã¢y lÃ  tham sá»‘ quan trá»ng trong SVM.

Sau Ä‘Ã³, tÃ´i sá»­ dá»¥ng GridSearchCV Ä‘á»ƒ thá»­ táº¥t cáº£ cÃ¡c giÃ¡ trá»‹ trong danh sÃ¡ch Ä‘Ã³ vÃ  Ä‘Ã¡nh giÃ¡ hiá»‡u suáº¥t cá»§a mÃ´ hÃ¬nh SVM vá»›i má»—i giÃ¡ trá»‹ cá»§a "C" trÃªn táº­p dá»¯ liá»‡u huáº¥n luyá»‡n. Báº±ng cÃ¡ch nÃ y, tÃ´i cÃ³ thá»ƒ tÃ¬m ra giÃ¡ trá»‹ tá»‘i Æ°u cho "C" mÃ  cáº£i thiá»‡n hiá»‡u suáº¥t cá»§a mÃ´ hÃ¬nh.

Sau khi thá»­ vá»›i cÃ¡c giÃ¡ trá»‹ C khÃ¡c nhau tá»« $10^{-3}$ cho Ä‘áº¿n 10 thÃ¬ giÃ¡ trá»‹ tá»‘t nháº¥t lÃ  0.01 vÃ  tÃ´i tiáº¿p tá»¥c thu háº¹p pháº¡m vi vÃ  nháº­n tháº¥y giÃ¡ trá»‹ C máº·c Ä‘á»‹nh váº«n lÃ  0.01 sáº½ cho ra Ä‘á»™ chÃ­nh xÃ¡c cao nháº¥t.

VÃ¬ tháº¿ tÃ´i sáº½ giá»¯ nguyÃªn siÃªu tham sá»‘ nÃ y Ä‘á»ƒ tiáº¿n hÃ nh stacking

### 3.3.2. Training cho **meta-model**

Quy trÃ¬nh:

Do tÃ i nguyÃªn cá»§a mÃ¡y tÃ´i khÃ´ng Ä‘á»§ Ä‘á»ƒ thá»±c hiá»‡n gridsearch tÃ¬m siÃªu tham sá»‘ tá»‘i Æ°u nháº¥t vá»›i mÃ´ hÃ¬nh Random Forest nÃªn tÃ´i sáº½ tiáº¿n hÃ nh luÃ´n bÆ°á»›c huáº¥n luyá»‡n cho meta model

Äáº§u tiÃªn tÃ´i khá»Ÿi táº¡o 2 mÃ´ hÃ¬nh cÆ¡ sá»Ÿ hiá»‡u quáº£ nháº¥t trong 3 mÃ´ hÃ¬nh tÃ´i Ä‘Ã£ Ä‘Ã¡nh giÃ¡ trÆ°á»›c Ä‘Ã³. Sau Ä‘Ã³ táº¡o mÃ´ má»™t ma tráº­n Ä‘áº·c trÆ°ng lÃ m Ä‘áº§u vÃ o huáº¥n luyá»‡n cho meta-model.

## 3.4. ÄÃ¡nh giÃ¡ meta-model

### 3.4.1. Accuracy

```python
Accuracy of svm model: 0.942596991290578
Accuracy of random forest model: 0.9338875692794932
Accuracy of stacked model: 0.9451702296120348
```

# 4. HÆ°á»›ng phÃ¡t triá»ƒn vÃ  cáº£i tiáº¿n

## **4.1. Cáº£i tiáº¿n trong tÆ°Æ¡ng lai**

**Vá» data:**

- Bá»• sung Ä‘a dáº¡ng cÃ¡c loáº¡i biá»ƒn bÃ¡o khÃ¡c, Ä‘áº·c biá»‡t lÃ  biá»ƒn bÃ¡o giao thÃ´ng Viá»‡t Nam
- TÃ¬m hiá»ƒu thÃªm cÃ¡c kÄ© thuáº­t tÄƒng cÆ°á»ng data. Viá»‡c Ã¡p dá»¥ng khÃ´ng hiá»‡u quáº£ cÃ¡c kÄ© thuáº­t tÄƒng cÆ°á»ng dá»¯ liá»‡u trong dá»± Ã¡n nÃ y cÃ ng cho tháº¥y tuy sá»‘ lÆ°á»£ng dá»¯ liá»‡u quan trá»ng nhÆ°ng cháº¥t lÆ°á»£ng dá»¯ liá»‡u cÅ©ng lÃ  má»™t yáº¿u tá»‘ áº£nh hÆ°á»Ÿng máº¡nh máº½ tá»›i Ä‘á»™ chÃ­nh xÃ¡c model.
- Viá»‡c sá»­ dá»¥ng thÆ° viá»‡n SMOTE Ä‘á»ƒ tÄƒng cÆ°á»ng dá»¯ liá»‡u áº£nh sau Ä‘Ã³ chia thÃ nh 3 táº­p cÃ³ thá»ƒ lÃ m cho dá»¯ liá»‡u bá»‹ overfitting lÃ m giáº£m hiá»‡u quáº£ Ä‘Ã¡nh giÃ¡. ChÃºng tÃ´i sáº½ tÃ¬m hiá»ƒu thÃªm nhá»¯ng cÃ¡ch khÃ¡c Ä‘á»ƒ tÄƒng cÆ°á»ng dá»¯ liá»‡u, tuy sá»‘ lÆ°á»£ng dá»¯ liá»‡u quan trá»ng nhÆ°ng cháº¥t lÆ°á»£ng dá»¯ liá»‡u cÅ©ng lÃ  má»™t yáº¿u tá»‘ áº£nh hÆ°á»Ÿng máº¡nh máº½ tá»›i Ä‘á»™ chÃ­nh xÃ¡c model.

**Vá» thuáº­t toÃ¡n:**

- Ãp dá»¥ng cÃ¡c ká»¹ thuáº­t Ensemble khÃ¡c thay vÃ¬ chá»‰ sá»­ dá»¥ng Stacking
- TÄƒng sá»‘ lÆ°á»£ng base model Ä‘á»ƒ tÄƒng Ä‘á»™ nháº­n diá»‡n cá»§a meta-model
- TÃ¬m kiáº¿m cÃ¡c siÃªu tham sá»‘ hiá»‡u quáº£ hÆ¡n khi cÃ³ Ä‘á»§ Ä‘iá»u kiá»‡n

## 4.2. HÆ°á»›ng phÃ¡t triá»ƒn

- Thu tháº­p thÃªm cÃ¡c áº£nh cÃ³ ngoáº¡i cáº£nh vÃ  thá»±c hiá»‡n label báº±ng tay sá»­ dá»¥ng **bounding box.**
- Nháº­n diá»‡n biá»ƒn bÃ¡o trong thá»i gian thá»±c vÃ  tráº£ vá» Ä‘áº§u ra dÆ°á»›i dáº¡ng Ã¢m thanh cho ngÆ°á»i dÃ¹ng.
- Nháº­n biáº¿t Ä‘Æ°á»£c biá»ƒn bÃ¡o vÃ  phÃ¢n loáº¡i Ä‘Æ°á»£c chÃ­nh xÃ¡c loáº¡i biá»ƒn bÃ¡o.

# 5. Video demo

Youtube link

# 6. Nguá»“n tham kháº£o

1. Data set: [GTSRB - German Traffic Sign Recognition Benchmark (kaggle.com)](https://www.kaggle.com/datasets/meowmeowmeowmeowmeow/gtsrb-german-traffic-sign)
2. HOG:Â https://viblo.asia/p/tim-hieu-ve-phuong-phap-mo-ta-dac-trung-hog-histogram-of-oriented-gradients-V3m5WAwxZO7
3. Máº¥t cÃ¢n báº±ng dá»¯ liá»‡u: [Khoa há»c dá»¯ liá»‡u (phamdinhkhanh.github.io)](https://phamdinhkhanh.github.io/2020/02/17/ImbalancedData.html)
4. GridSearchCV: [Tá»± há»c ML | Äiá»u chá»‰nh siÃªu tham sá»‘ SVM báº±ng GridSearchCV | ML Â» Cafedev.vn](https://cafedev.vn/tu-hoc-ml-dieu-chinh-sieu-tham-so-svm-bang-gridsearchcv-ml/)
5. SVM:Â https://machinelearningcoban.com/2017/04/09/smv/
